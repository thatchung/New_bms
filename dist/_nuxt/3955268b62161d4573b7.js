(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{589:function(t,e,n){"use strict";n(79),n(121),n(19),n(16),n(32),n(67),n(397),n(53);var r=n(0),o=n.n(r);e.a={filters:{formatTypeMoney:function(t){var e=t+"";return t&&e.length>0?e.replace(/\B(?=(\d{3})+(?!\d))/g,","):0},ageFilter:function(t){var e=Date.now()-t;if(e<0)return 0;var n=new Date(e);return Math.abs(n.getUTCFullYear()-1970)},dateFilter:function(t){return o()(t).format("DD/MM/YYYY")},dateTimeFilter:function(t){return o()(t).format("HH:mm:ss DD/MM/YYYY")},timeFilter:function(t){return o()(t).format("HH:mm")},dateTimeFilterComment:function(t){return o()(t).format("DD/MM/YYYY")+" lúc "+o()(t).format("HH:mm")},simpleStateFilter:function(t){var e="";switch(t){case"active":e="Active";break;case"inactive":e="Inactive"}return e},showStateFilter:function(t){var e="";switch(t){case"show":e="Hiển thị";break;case"hide":e="Ẩn"}return e},editorStateFilter:function(t){var e="";switch(t){case"draft":e="Bản nháp";break;case"submit":e="Mới";break;case"lock":e="Đã khóa";break;case"inactive":e="Đã block"}return e},confirmStateFilter:function(t){var e="";switch(t){case"not_yet":e="Chưa xong";break;case"new":e="Mới";break;case"confirm":e="Đã duyệt";break;case"reject":e="Từ chối";break;case"inactive":e="Đã block"}return e},reportReviewState:function(t){return{new:"Mới",in_progress:"Đã tiếp nhận",reject:"Đã từ chối",done:"Đã xử lý"}[t]},articleConfirmStateFilter:function(t){return{new:"Mới",confirm:"Duyệt",reject:"Từ chối"}[t]},typePostFilter:function(t){return{review:"App",news:"News",article:"Web",video:"Video"}[t]},removeCharTo70:function(t){var e=t;return t.length>70&&(e=t.substring(0,70)+"..."),e}},methods:{replaceImageByDefault:function(t){var img=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t.target.src=""!==img?img:"/images/no-image.png"},getListObjectDistinct:function(t){var e=t.array,n=t.commitArray,r=[];if(e&&e.length&&n&&n.length){var o=function(i){-1==n.findIndex((function(t){return t.uuid==e[i].uuid}))&&r.push(e[i])};for(var i in e)o(i);return r}return e},getListOrderBy:function(t){return t.array.sort((function(a,b){return Number(a.order)-Number(b.order)}))},isExistObject:function(t){var e=t.uuid;return t.array.findIndex((function(t){return t.uuid==e}))>-1},filterFieldNull:function(t){for(var form=t.form,object={},e=0,n=Object.keys(form);e<n.length;e++){var i=n[e],r=form[i];null!=r&&(object[i]=form[i])}return object},warningError:function(t){var e=t.message;this.$Notification({type:"error",title:"Lỗi",dangerouslyUseHTMLString:!0,message:e})},warningSuccess:function(t){var e=t.message;this.$Notification({type:"success",title:"Thành Công",dangerouslyUseHTMLString:!0,message:e})},getlinkimageresize:function(image,t){return image.includes("https://cdn01.diadiemanuong.com/ddau/")&&(image=(image=image.replace("999x",t)).replace("640x",t)),image}}}},594:function(t,e,n){"use strict";n(66),n(16),n(32),n(6);var r=n(1),o=(n(397),n(54),n(25),n(19),n(29)),c=n(33),l=(new Date).getTime(),m=function(t,e,n,i,s,r,a,o,c,l){"boolean"!=typeof a&&(o,o=a,a=!1);var u,m="function"==typeof n?n.options:n;if(t&&t.render&&(m.render=t.render,m.staticRenderFns=t.staticRenderFns,m._compiled=!0),u)if(m.functional){var d=m.render;m.render=function(t,e){return u.call(e),d(t,e)}}else{var f=m.beforeCreate;m.beforeCreate=f?[].concat(f,u):[u]}return n}({render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ckeditor"},[e("textarea",{attrs:{name:this.name,id:this.id,types:this.types,config:this.config,disabled:this.readOnlyMode},domProps:{value:this.value}})])},staticRenderFns:[]},0,{name:"VueCkeditor",props:{name:{type:String,default:function(){return"editor-".concat(++l)}},value:{type:String},id:{type:String,default:function(){return"editor-".concat(l)}},types:{type:String,default:function(){return"classic"}},config:{type:Object,default:function(){}},instanceReadyCallback:{type:Function},readOnlyMode:{type:Boolean,default:function(){return!1}}},data:function(){return{instanceValue:""}},computed:{instance:function(){return CKEDITOR.instances[this.id]}},watch:{value:function(t){try{this.instance&&this.update(t)}catch(t){}},readOnlyMode:function(t){this.instance.setReadOnly(t)}},mounted:function(){this.create()},methods:{create:function(){var t=this;"undefined"==typeof CKEDITOR?console.log("CKEDITOR is missing (http://ckeditor.com/)"):("inline"===this.types?CKEDITOR.inline(this.id,this.config):CKEDITOR.replace(this.id,this.config),this.instance.setData(this.value),this.instance.on("instanceReady",(function(){t.instance.setData(t.value)})),this.instance.on("change",this.onChange),this.instance.on("mode",this.onMode),this.instance.on("blur",(function(e){t.$emit("blur",e)})),this.instance.on("focus",(function(e){t.$emit("focus",e)})),this.instance.on("contentDom",(function(e){t.$emit("contentDom",e)})),CKEDITOR.on("dialogDefinition",(function(e){t.$emit("dialogDefinition",e)})),this.instance.on("fileUploadRequest",(function(e){t.$emit("fileUploadRequest",e)})),this.instance.on("fileUploadResponse",(function(e){setTimeout((function(){t.onChange()}),0),t.$emit("fileUploadResponse",e)})),void 0!==this.instanceReadyCallback&&this.instance.on("instanceReady",this.instanceReadyCallback),this.$once("hook:beforeDestroy",(function(){t.destroy()})))},update:function(t){this.instanceValue!==t&&(this.instance.setData(t,{internal:!1}),this.instanceValue=t)},destroy:function(){try{var t=window.CKEDITOR;t.instances&&t.instances[this.id]&&t.instances[this.id].destroy()}catch(t){}},onMode:function(){var t=this;if("source"===this.instance.mode){var e=this.instance.editable();e.attachListener(e,"input",(function(){t.onChange()}))}},onChange:function(){var t=this.instance.getData();t!==this.value&&(this.$emit("input",t),this.instanceValue=t)}}},0,0,0,void 0,void 0);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var f=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({props:{readonly:{type:Boolean,default:!1},uuid:{type:String,default:"editer-id"},messageHtml:{type:String,default:null},listImageUuid:{type:Array,default:[]},placeholder:{type:String}}},Object(c.b)({postbyUrl:"common/postbyUrl"}),{components:{"vue-ckeditor":m},computed:{message:{get:function(){return this.messageHtml},set:function(t){this.$emit("update:messageHtml",t)}},readonlymode:{get:function(){return this.readonly}}},data:function(){return{listMedia:[],config:{filebrowserBrowseUrl:"/media",toolbar:[{name:"document",items:["Source","-","Save","Preview","Print"]},{name:"clipboard",items:["Cut","Copy","Paste","PasteText","PasteFromWord","-","Undo","Redo"]},"/",{name:"basicstyles",items:["Find","SelectAll","-","Bold","Italic","Underline","Strike","Subscript","Superscript","-","CopyFormatting","RemoveFormat","TextColor","BGColor"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock","Language"]},{name:"links",items:["Link","Unlink"]},{name:"insert",items:["Font","FontSize","Image","Flash","Table","HorizontalRule","Smiley","SpecialChar","Iframe","uploadimagefile"]}],height:300},current_img:null}},beforeMount:function(){window.localStorage.hasOwnProperty("list_image")&&window.localStorage.removeItem("list_image")},mounted:function(){!this.placeholder||this.messageHtml&&""!=this.messageHtml&&null!=this.messageHtml||(this.message='<p style="color: #5d5d5d;">'+this.placeholder+"</p>")},beforeUpdate:function(){this.checkData()},methods:{onBlur:function(t){this.checkData()},onFocus:function(t){this.checkData()},onContentDom:function(t){this.checkData()},onDialogDefinition:function(t){},checkData:function(){var t=this;if(window.localStorage.hasOwnProperty("list_image")){var e=JSON.parse(window.localStorage.getItem("list_image")),n=!0,r=!1,o=void 0;try{for(var c,l=function(){var img=c.value;t.listImageUuid.findIndex((function(t){return t==img}))<0&&t.listImageUuid.push(img)},m=e[Symbol.iterator]();!(n=(c=m.next()).done);n=!0)l()}catch(t){r=!0,o=t}finally{try{n||null==m.return||m.return()}finally{if(r)throw o}}}this.message&&this.$emit("update:messageHtml",this.messageHtml),this.$emit("update:listImage",this.listImageUuid),this.$emit("load")},loadImageFile:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,i,o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=t.target.files,i=0;case 2:if(!(i<r.length)){n.next=20;break}if(!(r[i].size>=3e6)){n.next=8;break}return e.$Notification({type:"warning",title:"Chú ý!",message:"File ảnh tải lên có dung lượng vượt mức 3MB!"}),n.abrupt("return");case 8:return o=e.warterMark?{apply_watermark:!0,watermark_with_name:!0,author_uuid:e.author_uuid}:{},n.next=11,e.$callApi({method:"post",lixi_review:!0,imageFile:r[i],url:"media/image",data:o});case 11:if((c=n.sent).meta.success){n.next=14;break}return n.abrupt("return");case 14:if(0!=c.data.length){n.next=16;break}return n.abrupt("return");case 16:CKEDITOR.instances["editer-id"].insertHtml("<p style='text-align: center;'><img data-uploaded='Uploaded' src='"+c.data[0].media_link+"' style='display: block;  max-width: 96%;margin:0px auto;' /></p>");case 17:i++,n.next=2;break;case 20:case"end":return n.stop()}}),n)})))()}},watch:{deep:!0}}),h=n(3),component=Object(h.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vue-ckeditor",{attrs:{readOnlyMode:t.readonlymode,id:t.uuid,config:t.config},on:{blur:function(e){return t.onBlur(e)},focus:function(e){return t.onFocus(e)},contentDom:function(e){return t.onContentDom(e)},dialogDefinition:function(e){return t.onDialogDefinition(e)}},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),t._v(" "),n("input",{staticStyle:{display:"none"},attrs:{id:"edit-bt-image-button",type:"file",accept:"image/*",multiple:""},on:{change:t.loadImageFile}})],1)}),[],!1,null,null,null);e.a=component.exports},611:function(t,e,n){"use strict";n.r(e);n(66),n(25),n(19),n(16),n(32),n(6);var r=n(1),o=n(29),c=n(589),l=n(33),m=n(30),d=n(594);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v={layout:"app",mixins:[c.a],components:{"ckeditor-html":d.a},computed:h({},Object(l.c)({profile:"common/getProfile"})),filters:{stateFilter:function(t){var e={active:"Active",inactive:"Inactive"};return t in e?e[t]:t},channelFilter:function(t){var e={google:"Google",facebook:"Facebook"};return t in e?e[t]:t}},data:function(){return{isLoading:!1,timemission:[],form:{user_id:null,name:null,channel:"facebook",cover_link:null,description:null,status:"active"}}},mounted:function(){this.$route.params.id?this.loadData():(this.warningError({message:"Không tìm thấy chiến dịch"}),this.$router.push("/mission"))},methods:h({},Object(l.b)({getMissionById:"mission/getMissionById",updateMission:"mission/updateMission"}),{loadData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMissionById({id:t.$route.params.id});case 2:t.form=e.sent,t.form.start_time&&t.timemission.push(t.form.start_time),t.form.end_time&&t.timemission.push(t.form.end_time);case 5:case"end":return e.stop()}}),e)})))()},editMission:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.form,t.timemission&&2==t.timemission.length){e.next=3;break}return e.abrupt("return");case 3:if(r=new Date(t.timemission[0]),o=new Date(t.timemission[1]),n.start_time=r.getTime(),n.end_time=o.getTime(),0!=n.s_time&&0!=n.e_time){e.next=10;break}return t.$Notification({type:"warning",title:"Thất bại",message:"Chưa chọn thời gian chiến dịch."}),e.abrupt("return");case 10:return e.next=12,m.a.showConfirm(t);case 12:t.updateMission({params:n,callback:{success:function(e){t.$Notification({type:"success",title:"Thành công",message:"Cập nhật chiến dịch thành công"}),t.loadData()},error:function(e){t.$Notification({type:"error",title:"Thất bại",message:"Có lỗi xảy ra"})}}});case 13:case"end":return e.stop()}}),e)})))()}})},y=n(3),component=Object(y.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},[n("div",{staticClass:"container"},[n("breadcrumb",{attrs:{title:"Cập nhật chiến dịch"}}),t._v(" "),n("div",{staticClass:"row m-t-10"},[n("fieldset",{staticStyle:{"min-height":"200px"}},[n("div",{staticClass:"row m-t-10"},[n("div",{staticClass:"col-md-12"},[t._m(0),t._v(" "),n("div",{staticClass:"col-md-9"},[n("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)])]),t._v(" "),n("div",{staticClass:"row m-t-10"},[n("div",{staticClass:"col-md-12"},[t._m(1),t._v(" "),n("div",{staticClass:"col-md-9"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.form.channel,expression:"form.channel"}],staticClass:"form-control",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form,"channel",e.target.multiple?n:n[0])}}},t._l(["facebook","google"],(function(e){return n("option",{key:e,attrs:{label:t._f("channelFilter")(e)},domProps:{value:e}})})),0)])])]),t._v(" "),n("div",{staticClass:"row m-t-10"},[n("div",{staticClass:"col-md-12"},[t._m(2),t._v(" "),n("div",{staticClass:"col-md-9"},[n("el-date-picker",{attrs:{type:"datetimerange","range-separator":"To","start-placeholder":"Ngày bắt đầu","end-placeholder":"Ngày kết thúc"},model:{value:t.timemission,callback:function(e){t.timemission=e},expression:"timemission"}})],1)])]),t._v(" "),n("div",{staticClass:"row m-t-10"},[n("div",{staticClass:"col-md-12"},[t._m(3),t._v(" "),n("div",{staticClass:"col-md-9"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.form.status,expression:"form.status"}],staticClass:"form-control",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form,"status",e.target.multiple?n:n[0])}}},t._l(["active","inactive"],(function(e){return n("option",{key:e,attrs:{label:t._f("stateFilter")(e)},domProps:{value:e}})})),0)])])]),t._v(" "),n("div",{staticClass:"row m-t-10"},[n("div",{staticClass:"col-md-12"},[t._m(4),t._v(" "),n("div",{staticClass:"col-md-3"},[n("image-link",{attrs:{link:t.form.cover_link,imageradius:5,"image-width":200,"image-height":100},on:{"update:link":function(e){return t.$set(t.form,"cover_link",e)}}})],1)])]),t._v(" "),n("div",{staticClass:"row m-t-10"},[n("div",{staticClass:"col-md-12"},[t._m(5),t._v(" "),n("div",{staticClass:"col-md-9"},[n("ckeditor-html",{attrs:{"message-html":t.form.description,readonly:!1,"list-image-uuid":[],uuid:"content_review"},on:{"update:messageHtml":function(e){return t.$set(t.form,"description",e)},"update:message-html":function(e){return t.$set(t.form,"description",e)}}})],1)])]),t._v(" "),n("div",{staticClass:"row m-t-10"},[n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"col-xs-12"},[n("button",{staticClass:"pull-right btn btn-danger",attrs:{type:"button",disabled:t.isLoading},on:{click:function(e){return t.editMission()}}},[n("i",{staticClass:"mdi mdi-content-save"}),t._v("\n                    Lưu\n                    "),t.isLoading?n("i",{staticClass:"fa fa-spinner fa-spin"}):t._e()])])])])])])],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-3"},[e("label",{attrs:{for:""}},[this._v("Tên chiến dịch: ")]),this._v(" "),e("span",{staticClass:"text-danger"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-3"},[e("label",{attrs:{for:""}},[this._v("Kênh triển khai:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-3"},[e("label",{attrs:{for:""}},[this._v("Thời gian : ")]),this._v(" "),e("span",{staticClass:"text-danger"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-3"},[e("label",{attrs:{for:""}},[this._v("Trạng thái:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-3"},[e("label",{attrs:{for:""}},[this._v("Cover:")]),this._v(" "),e("span",{staticClass:"text-danger"},[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-3"},[e("label",{attrs:{for:""}},[this._v("Mô tả: ")])])}],!1,null,null,null);e.default=component.exports}}]);