const { task, src, series } = require('gulp');
const eslint = require('gulp-eslint');
const jest = require('gulp-jest').default;

// kiểm tra code bằng eslint
task('lint', () =>
    src([
        'index.js',
        'module/**/*.js',
        'test/**/*.js',
        '!module/document_server/dist/**/*.js',
        '!module/swagger/swagger-ui/*.js'
    ])
        .pipe(eslint())
        .pipe(eslint.format())
        .pipe(eslint.failAfterError())
);

// khởi chạy jest để thực thi các unit-test
task('jest', () => src('test').pipe(jest()));

// run tasks
task('run:test', series('lint', 'jest'));
