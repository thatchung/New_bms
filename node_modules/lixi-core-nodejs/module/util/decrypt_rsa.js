let crypto = require('crypto');
let constants = require('constants');

module.exports = expo =>
    (expo.decryptRSA = function({ private_key, data }) {
        if (!private_key) throw Error('private key is undefined');
        if (typeof data !== 'string') throw Error('data must be string type');


        let privateKey = private_key;
        let buffer = Buffer.from(data, "hex");
        let decrypted = crypto.privateDecrypt({
            key: privateKey,
            padding: constants.RSA_PKCS1_PADDING 
        }, buffer);
        return JSON.parse(decrypted.toString("utf8"));
    });
