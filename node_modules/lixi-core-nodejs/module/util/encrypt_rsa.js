let crypto = require('crypto');
let constants = require('constants');

module.exports = expo =>
    (expo.encryptRSA = function({ public_key, data }) {
        if (!public_key) throw Error('public key is undefined');
        if (typeof data !== 'string') throw Error('data must be string type');

        let publicKey = public_key;
        let buffer = Buffer.from(data);
        let encrypted = crypto.publicEncrypt({
            key: publicKey,
            padding: constants.RSA_PKCS1_PADDING 
        }, buffer);

        return encrypted.toString("hex");
    });
