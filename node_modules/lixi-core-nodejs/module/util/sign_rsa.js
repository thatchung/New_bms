let crypto = require('crypto');

module.exports = expo =>
    (expo.signRSA = function({ data, private_key }) {
        if (!private_key) throw Error('private key is undefined');
        if (typeof data !== 'string') throw Error('data must be string type');

        const signer = crypto.createSign('md5');
        signer.update(data);
        return signer.sign(Buffer.from(private_key, "utf8"), 'hex');
    });
