let crypto = require('crypto');

module.exports = expo =>
    (expo.verifySignatureRSA = function({ publicKey, signature, data }) {
        if (!publicKey) throw Error('public key is undefined');
        if (typeof data !== 'string') throw Error('data must be string type');

        const verifier = crypto.createVerify('md5');
        verifier.update(data);
        const publicKeyBuf = Buffer.from(publicKey, 'utf8');
        const signatureBuf = Buffer.from(signature, 'hex');
        return verifier.verify(publicKeyBuf, signatureBuf);
    });
