# Request Log (Elasticsearch 7.2)
----------
## install
```sh
$ npm i git+https://lixitech:12345678@bitbucket.org/lixidev/request-log.git
$ npm i git+https://lixitech:12345678@bitbucket.org/lixidev/request-log.git#custom
```

## Request In
```js
const Express = require('express');
const RequestLog = require('request-log');
const app = Express();
const port = 3000;

// setup connection
RequestLog.RequestIn.setup({
    enable: true,
    service_name: 'demo',
    connection: {
        host: 'https://elk.lixiapp.com/',
        keepAlive: false,
        log: 'trace',
    },
});

// setup middleware before any route
app.use(RequestLog.RequestIn.before);

app.get('/', (req, res, next) => {
    res.send('Hello World!');
    next();
});

// setup middleware after any route
app.use(RequestLog.RequestIn.after);

app.listen(port, () => {
    console.log(`Example app listening on port ${port}!`)
});
```

## Request Out
```js
const Express = require('express');
const RequestLog = require('request-log');

(async () => {
    // setup connection
    await RequestLog.RequestOut.setup({
        enable: true,
        service_name: 'demo',
        connection: {
            host: 'https://elk.lixiapp.com/',
            keepAlive: false,
            log: 'trace',
        },
    });

    const res = await require('axios')({
        method: 'GET',
        url: 'https://jsonplaceholder.typicode.com/todos/1',
    });
})()
```

## Advanced
```js
RequestLog.RequestIn.setup({
    enable: true,
    service_name: 'demo',
    connection: {
        host: 'https://elk.lixiapp.com/',
        keepAlive: false,
        log: 'trace',
    },
    // log all request
    filter: ({ _debug, _config, host, method, url, curl }) => {
        return true;
    },

    // dont save response data for success get request
    customResponse: ({ 
        _debug, _response, responseData, responseHeader, httpCode, 
        httpText, responseTime, host, method, url, curl, processTime 
    }) => {

        if (method.toLowerCase() === 'get' && httpCode == 200) {
            responseData = null;
            responseHeader = null;
        }

        return {
            response_data: responseData,
            response_header: responseHeader,
            http_code: httpCode,
            http_text: httpText,
            response_time: responseTime,
        }
    },
});
```


