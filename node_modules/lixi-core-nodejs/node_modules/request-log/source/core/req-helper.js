const Moment = require('moment');
const Req2Curl = require('./req2curl');

module.exports = class ReqHelper {
    static parse(req) {
        const method = req.method.toLowerCase();
        const host = req.hostname.toLowerCase();
        const protocol = req.protocol.toLowerCase();
        const pathname = req.path.toLowerCase();

        const result = {
            id: req.headers['X-Request-ID'] || Moment().valueOf(),
            url: req.url,
            method: method,
            protocol: protocol,
            host: host,
            pathname: pathname,
            custom_url: `${method} ${protocol}//${host}${pathname}`,
            curl: Req2Curl(req),
            request_time: Moment().valueOf(),
        };
        return result;
    }
}