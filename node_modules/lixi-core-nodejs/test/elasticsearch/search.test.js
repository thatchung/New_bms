let { Joi, Elasticsearch } = require('../../index');

test(`search`, async () => {
    let es = Elasticsearch.init({ node: 'http://10.39.93.27:9202' });

    let result = await es
        .query()
        .index('lixi_core_unit_test')
        .filterMust({ term: { method: 'get' } })
        .size(5)
        .search();

    let schema = Joi.object({
        total: Joi.number().required(),
        items: Joi.array()
            .items(Joi.object())
            .length(5)
            .required()
    });

    Joi.assert(result, schema);
    for (let item of result.items) {
        expect(item.method).toEqual('get');
    }
});
